<? namespace Bitrix\Main\Security\W\Rules;$GLOBALS['____1143194375']= array(base64_decode('aXN'.'f'.'c3Ry'.'aW'.'5n'),base64_decode('c3R'.'ydG9sb3dlcg=='),base64_decode('aXNf'.'Y'.'XJyYXk='),base64_decode('aXN'.'fc3RyaW5'.'n'),base64_decode('Z3pkZWNvZGU='),base64_decode('YmFzZT'.'Y0X2RlY2'.'9kZ'.'Q=='),base64_decode('dXJ'.'sZGVj'.'b2Rl'),base64_decode('Y'.'XJy'.'YXlfc'.'mV'.'2Z'.'XJzZQ'.'=='),base64_decode('Z3plbmNv'.'ZGU='),base64_decode('YmFzZTY0X2V'.'uY29kZQ=='),base64_decode('dXJsZW5jb2Rl'),base64_decode(''.'Ym'.'luMmh'.'leA=='),base64_decode('aXNf'.'YXJ'.'yYX'.'k='),base64_decode('c3RydG'.'9sb3'.'d'.'lc'.'g=='),base64_decode('a'.'XNfY'.'XJyYXk='),base64_decode('a'.'m9pbg='.'='),base64_decode('Z'.'m5'.'tY'.'XRja'.'A=='),base64_decode('c'.'mF3d'.'XJsZGV'.'jb'.'2'.'Rl'),base64_decode('c'.'3'.'Vic3Ry'),base64_decode('c3Vic3Ry'),base64_decode('c3Ry'.'X3JlcG'.'xhY'.'2U='),base64_decode('cHJlZ19xdW'.'90ZQ=='),base64_decode(''.'cHJlZ1'.'9tY'.'X'.'Rja'.'A'.'=='));if(!function_exists(__NAMESPACE__.'\\___1653448151')){function ___1653448151($_1553130701){static $_2087523743= false; if($_2087523743 == false) $_2087523743=array('Y'.'WN0'.'a'.'W9u','a'.'W'.'50dmFs',''.'cGF0aA='.'=','Y29udGV4dA==','a2V5c'.'w==',''.'cHJvY2Vz'.'cw==','ZW5jb2Rp'.'bmc=','cHJ'.'l'.'Z19yZ'.'XBs'.'YWNl','cG'.'F0aA==','Y'.'29udG'.'V4dA==','a'.'2V5c'.'w==',''.'cHJvY2V'.'zcw==','Z'.'W5'.'jb2Rpbmc=',''.'cGF0dGV'.'ybg==',''.'cHJl'.'Z1'.'9'.'tY'.'XRjaA'.'='.'=','cGF0aA==','Y29'.'u'.'d'.'GV4dA==',''.'a'.'2'.'V5cw'.'='.'=',''.'cHJvY2Vzcw==',''.'ZW5jb2'.'R'.'p'.'bmc'.'=','cGF0dGV'.'ybg'.'==','cG9z'.'dF'.'9h'.'Y3Rpb24=',''.'Y2'.'h'.'lY2tfY3NyZg==','cGF0'.'aA='.'=','Y29'.'ud'.'GV4d'.'A==',''.'a2V5c'.'w'.'==','cH'.'J'.'vY'.'2V'.'z'.'cw='.'=',''.'ZW5'.'jb2Rpbmc=','cGF0dGV'.'yb'.'g==','YWN0aW9u','YWN0aW9u','YWN0a'.'W9u','YWN'.'0aW9u','YW'.'N0'.'aW'.'9u','Y'.'WN0aW9u','cG9z'.'dF9hY3Rp'.'b24=','ZW5jb2Rpbmc=','Z'.'W5'.'jb2R'.'pb'.'mc'.'=','ZW'.'5'.'j'.'b'.'2Rpbmc=','ZW5'.'jb2'.'R'.'pb'.'mc=','ZW5jb2Rpbmc=','ZW5'.'j'.'b2'.'Rpbmc=','Z3o=',''.'YmFzZ'.'TY0',''.'dXJs','aG'.'V4','Lg==','Lw==',''.'aW'.'5kZX'.'gucGhw',''.'L2luZG'.'V4LnBo'.'cA==','U'.'0NS'.'SVBUX0'.'5BTUU=','L2lu'.'ZGV'.'4LnBocA==',''.'U0NSSVBU'.'X05'.'BTU'.'U=','U'.'0NSSVBUX0'.'5'.'BTU'.'U=','U0'.'NSS'.'VB'.'UX05BTUU=','fg==','fl4'.'=','fg==',''.'XH4=','JH4=');return base64_decode($_2087523743[$_1553130701]);}}; use Bitrix\Main\IO\Path; use Bitrix\Main\Web\Uri; use Bitrix\Main\Security\W\Rules\Results\ModifyResult; abstract class Rule{ protected $_856309585; protected $_1417436066; protected $_1879449436; protected $_2146282098; protected $_10348253; public static function make(array $_1276316387):?static{ $_1276316387= static::prepareRuleParameters($_1276316387); return match($_1276316387[___1653448151(0)]){ ___1653448151(1) => new IntvalRule( $_1276316387[___1653448151(2)], $_1276316387[___1653448151(3)], $_1276316387[___1653448151(4)], $_1276316387[___1653448151(5)], $_1276316387[___1653448151(6)]), ___1653448151(7) => new PregReplaceRule( $_1276316387[___1653448151(8)], $_1276316387[___1653448151(9)], $_1276316387[___1653448151(10)], $_1276316387[___1653448151(11)], $_1276316387[___1653448151(12)], $_1276316387[___1653448151(13)]), ___1653448151(14) => new PregMatchRule( $_1276316387[___1653448151(15)], $_1276316387[___1653448151(16)], $_1276316387[___1653448151(17)], $_1276316387[___1653448151(18)], $_1276316387[___1653448151(19)], $_1276316387[___1653448151(20)], $_1276316387[___1653448151(21)]), ___1653448151(22) => new CsrfRule( $_1276316387[___1653448151(23)], $_1276316387[___1653448151(24)], $_1276316387[___1653448151(25)], $_1276316387[___1653448151(26)], $_1276316387[___1653448151(27)], $_1276316387[___1653448151(28)],), default => null,};} protected static function prepareRuleParameters(array $_1815170828): array{ if($GLOBALS['____1143194375'][0]($_1815170828[___1653448151(29)])){ $_1815170828[___1653448151(30)]= $GLOBALS['____1143194375'][1]($_1815170828[___1653448151(31)]);} elseif($GLOBALS['____1143194375'][2]($_1815170828[___1653448151(32)])){ $_1014627658= $_1815170828[___1653448151(33)]; $_1815170828[___1653448151(34)]= $_1014627658[(1384/2-692)]; $_1815170828[___1653448151(35)]= $_1014627658[round(0+0.25+0.25+0.25+0.25)];} $_1815170828[___1653448151(36)]=!empty($_1815170828[___1653448151(37)])? $_1815170828[___1653448151(38)]:[]; if($GLOBALS['____1143194375'][3]($_1815170828[___1653448151(39)])){ $_1815170828[___1653448151(40)]=[$_1815170828[___1653448151(41)]];} return $_1815170828;}  public function __construct($_856309585, $_1417436066, $_1879449436, $_2146282098, $_10348253){ $this->_856309585= $_856309585; $this->_1417436066= $this->castContext($_1417436066); $this->_1879449436= $this->castKeys($_1879449436); $this->_2146282098= $_2146282098; $this->_10348253= $_10348253;} public function evaluateValue($_2122156986){ if(!empty($this->_10348253)){ foreach($this->_10348253 as $_334387671){ $_2122156986= match($_334387671){ 'gz' => $GLOBALS['____1143194375'][4]($_2122156986), 'base64' => $GLOBALS['____1143194375'][5]($_2122156986), 'url' => $GLOBALS['____1143194375'][6]($_2122156986), 'hex' => hex2bin($_2122156986)};}} $_795532268= $this->evaluate($_2122156986); if(!empty($this->_10348253) && $_795532268 instanceof ModifyResult){ $_837915552= $_795532268->getCleanValue(); foreach($GLOBALS['____1143194375'][7]($this->_10348253) as $_334387671){ $_837915552= match($_334387671){ ___1653448151(42) => $GLOBALS['____1143194375'][8]($_837915552), ___1653448151(43) => $GLOBALS['____1143194375'][9]($_837915552), ___1653448151(44) => $GLOBALS['____1143194375'][10]($_837915552), ___1653448151(45) => $GLOBALS['____1143194375'][11]($_837915552)};} $_795532268= new ModifyResult($_837915552);} return $_795532268;} abstract public function evaluate($_2122156986); protected function castContext($_1417436066){ if(!$GLOBALS['____1143194375'][12]($_1417436066)){ $_1417436066=[$_1417436066];} foreach($_1417436066 as $_897774112 => $_1728150653){ $_1417436066[$_897774112]= $GLOBALS['____1143194375'][13]($_1728150653);} return $_1417436066;} protected function castKeys($_1879449436){ if(!$GLOBALS['____1143194375'][14]($_1879449436)){ $_1879449436=[$_1879449436];} return $_1879449436;} public function matchKey(array $_14337357): bool{ $_14337357= $GLOBALS['____1143194375'][15](___1653448151(46), $_14337357); foreach($this->_1879449436 as $_1606534212){   if($GLOBALS['____1143194375'][16]($_1606534212, $_14337357)){ return true;}} return false;}  public function matchPath($_464088526){ if($this->_856309585 === '*'){ return true;}  $_874623587= new Uri($_464088526); $_1185562643= $_874623587->getPath(); $_1185562643= $GLOBALS['____1143194375'][17]($_1185562643);      if(str_ends_with($_1185562643, ___1653448151(47))){ $_1185562643 .= ___1653448151(48);} $_1185562643= Path::normalize($_1185562643);  $_54974167[]= $_1185562643; if(str_ends_with($_1185562643, ___1653448151(49))){ $_54974167[]= $GLOBALS['____1143194375'][18]($_1185562643, min(30,0,10),-round(0+3+3+3));} elseif(str_ends_with($_SERVER[___1653448151(50)], ___1653448151(51))){ $_54974167[]= $GLOBALS['____1143194375'][19]($_SERVER[___1653448151(52)],(225*2-450),-round(0+4.5+4.5));} if($_1185562643 !== $_SERVER[___1653448151(53)]){ $_54974167[]= $_SERVER[___1653448151(54)];}  if(str_starts_with($this->_856309585, ___1653448151(55))){ $_844231500= $this->_856309585;} else{ $_844231500= ___1653448151(56). $GLOBALS['____1143194375'][20](___1653448151(57), ___1653448151(58), $GLOBALS['____1143194375'][21]($this->_856309585)). ___1653448151(59);} foreach($_54974167 as $_1267214527){ if($this->_856309585 === $_1267214527 || $GLOBALS['____1143194375'][22]($_844231500, $_1267214527)){ return true;}} return false;}  public function getPath(){ return $this->_856309585;}  public function getContext(){ return $this->_1417436066;}  public function getKeys(){ return $this->_1879449436;}  public function getProcess(){ return $this->_2146282098;}}?>